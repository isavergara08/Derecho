<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Plan de estudios â€“ Derecho</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}

body{
  font-family:'Poppins',sans-serif;
  font-size:15px;
  background:linear-gradient(#f7efff,#fcfaff);
  padding:30px;
}

h1{font-size:32px;margin-bottom:6px}
p{font-size:17px}

.header{text-align:center;margin-bottom:30px;}

.progress-container{
  width:60%;
  margin:10px auto;
  height:16px;
  background:#e5d3ff;
  border-radius:999px;
}
.progress-bar{
  height:100%;
  background:#8238FF;
  width:0%;
  border-radius:999px;
}

.menu{text-align:center;margin-top:15px;}
.menu button{
  font-size:15px;
  padding:8px 18px;
  border:none;
  border-radius:20px;
  background:#e8d4ff;
  cursor:pointer;
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:30px;
}

.card{
  background:#faf4ff;
  border:2px solid #d9b8ff;
  border-radius:22px;
  padding:16px;
}

.card.sem-10{grid-column:2/3}

.sem-title{
  font-size:19px;
  background:#8238FF;
  color:white;
  padding:10px;
  border-radius:14px;
  text-align:center;
  font-weight:600;
}

.info-line{
  text-align:center;
  margin:10px 0;
  font-size:15px;
  font-weight:600; /* ðŸ”¥ vuelve la negrita */
}

.subject{
  font-size:15px;
  background:#f1e6ff;
  padding:11px;
  border-radius:16px;
  margin-bottom:8px;
  cursor:grab;
  user-select:none;
}

.subject.checked{
  background:#dcc3ff;
  text-decoration:line-through;
  color:#6f4aa8;
}

.subject.dragging{opacity:.4;}
</style>
</head>

<body>

<div class="header">
  <h1>Plan de estudios â€“ Derecho</h1>
  <p>CrÃ©ditos aprobados: <strong><span id="approvedCredits">0</span></strong> / 183</p>
  <div class="progress-container">
    <div id="progress" class="progress-bar"></div>
  </div>
  <div class="menu">
    <button onclick="resetAll()">Reiniciar</button>
  </div>
</div>

<div id="grid" class="grid"></div>

<script>
const TOTAL = 183;

const baseSemesters = [
 {name:'1Â° semestre',subjects:[
  {name:'LÃ³gica y RetÃ³rica',credits:3,done:false},
  {name:'TeorÃ­a General del Estado',credits:3,done:false},
  {name:'IntroducciÃ³n al Derecho',credits:4,done:false},
  {name:'MatemÃ¡ticas',credits:3,done:false},
  {name:'Escritura Universitaria I',credits:2,done:false},
  {name:'CBU 1 â€“ Colombia paÃ­s de desigualdades',credits:2,done:false}
 ]},
 {name:'2Â° semestre',subjects:[
  {name:'HermenÃ©utica JurÃ­dica',credits:3,done:false},
  {name:'Derecho Romano',credits:3,done:false},
  {name:'SociologÃ­a JurÃ­dica',credits:3,done:false},
  {name:'Historia de las Instituciones JurÃ­dicas',credits:3,done:false},
  {name:'Escritura Universitaria II',credits:2,done:false},
  {name:'CBU 2 â€“ Teatro, juventud y rebeliÃ³n',credits:2,done:false},
  {name:'CBU 3 â€“ Colombia, espacio y tiempo',credits:2,done:false}
 ]},
 {name:'3Â° semestre',subjects:[
  {name:'Juez e InterpretaciÃ³n Constitucional',credits:3,done:false},
  {name:'Obligaciones I',credits:5,done:false},
  {name:'Derecho Constitucional',credits:5,done:false},
  {name:'Propiedad y Derechos Reales',credits:3,done:false},
  {name:'CBU 4 â€“ Cantos de boga',credits:2,done:false},
  {name:'Curso Libre ElecciÃ³n 1',credits:3,done:false}
 ]},
 {name:'4Â° semestre',subjects:[
  {name:'TeorÃ­a JurÃ­dica',credits:5,done:false},
  {name:'Obligaciones II',credits:5,done:false},
  {name:'LegislaciÃ³n y PolÃ­ticas PÃºblicas',credits:3,done:false},
  {name:'Derecho Internacional',credits:3,done:false},
  {name:'CBU 5 â€“ Quijote, dilemas universales',credits:2,done:false}
 ]},
 {name:'5Â° semestre',subjects:[
  {name:'Procedimientos',credits:4,done:false},
  {name:'Relaciones Laborales',credits:3,done:false},
  {name:'Derecho Comercial',credits:3,done:false},
  {name:'Derecho Penal',credits:3,done:false},
  {name:'Derecho PÃºblico Administrativo',credits:3,done:false},
  {name:'CBU 6 â€“ Mentalidad de Crecimiento',credits:2,done:false}
 ]},
 {name:'6Â° semestre',subjects:[
  {name:'ProtecciÃ³n Laboral',credits:3,done:false},
  {name:'Pruebas',credits:3,done:false},
  {name:'Contratos',credits:5,done:false},
  {name:'Penal Especial',credits:3,done:false},
  {name:'ArgumentaciÃ³n Procesos Civiles',credits:3,done:false},
  {name:'Materia Facultativa 1',credits:3,done:false}
 ]},
 {name:'7Â° semestre',subjects:[
  {name:'Relaciones Familiares',credits:4,done:false},
  {name:'Sociedades',credits:3,done:false},
  {name:'Contratos Estatales',credits:3,done:false},
  {name:'Proceso Ejecutivo y Declarativo',credits:3,done:false},
  {name:'ArgumentaciÃ³n Procesos Penales',credits:3,done:false},
  {name:'CBU 7 â€“ Historia del Sexo',credits:2,done:false},
  {name:'Materia Facultativa 2',credits:3,done:false}
 ]},
 {name:'8Â° semestre',subjects:[
  {name:'Acciones PÃºblicas',credits:3,done:false},
  {name:'TÃ­tulos Valores',credits:3,done:false},
  {name:'Derecho Comparado',credits:3,done:false},
  {name:'Ã‰tica Profesional',credits:3,done:false},
  {name:'Derecho Internacional Privado',credits:3,done:false},
  {name:'Materia Facultativa 3',credits:3,done:false},
  {name:'Curso Libre ElecciÃ³n 2',credits:3,done:false}
 ]},
 {name:'9Â° semestre',subjects:[
  {name:'Opciones de Grado',credits:6,done:false},
  {name:'Consultorio JurÃ­dico I',credits:4,done:false},
  {name:'Materia Facultativa 4',credits:3,done:false},
  {name:'Materia Facultativa 5',credits:3,done:false},
  {name:'Curso Libre ElecciÃ³n 3',credits:3,done:false}
 ]},
 {name:'10Â° semestre',subjects:[
  {name:'Consultorio JurÃ­dico II',credits:4,done:false},
  {name:'Materia Facultativa 6',credits:3,done:false}
 ]}
];

let semesters = JSON.parse(localStorage.getItem('malla')) 
  || JSON.parse(JSON.stringify(baseSemesters));

let dragData=null;

function save(){localStorage.setItem('malla',JSON.stringify(semesters));}
function resetAll(){
  semesters = JSON.parse(JSON.stringify(baseSemesters));
  save(); render();
}

function render(){
 const grid=document.getElementById('grid');
 grid.innerHTML='';
 let approvedTotal=0;

 semesters.forEach((sem,si)=>{
  const card=document.createElement('div');
  card.className='card'+(sem.name.startsWith('10')?' sem-10':'');

  const approved=sem.subjects.filter(s=>s.done).reduce((a,b)=>a+b.credits,0);
  const total=sem.subjects.reduce((a,b)=>a+b.credits,0);
  approvedTotal+=approved;

  card.innerHTML=`
    <div class="sem-title">${sem.name}</div>
    <div class="info-line">${approved} / ${total}</div>
  `;

  const list=document.createElement('div');

  list.ondragover=e=>{
    e.preventDefault();
    const after=getAfter(list,e.clientY);
    if(after==null) list.appendChild(dragData.el);
    else list.insertBefore(dragData.el,after);
  };

  list.ondrop=()=>{
    const moved=semesters[dragData.fromSem].subjects.splice(dragData.fromIdx,1)[0];
    const newIdx=[...list.children].indexOf(dragData.el);
    sem.subjects.splice(newIdx,0,moved);
    save(); render();
  };

  sem.subjects.forEach((sub,ci)=>{
    const div=document.createElement('div');
    div.className='subject'+(sub.done?' checked':'');
    div.textContent=`${sub.name} (${sub.credits})`;
    div.draggable=true;

    div.onclick=()=>{sub.done=!sub.done; save(); render();};

    div.ondragstart=()=>{
      dragData={el:div,fromSem:si,fromIdx:ci};
      div.classList.add('dragging');
    };

    div.ondragend=()=>div.classList.remove('dragging');

    list.appendChild(div);
  });

  card.appendChild(list);
  grid.appendChild(card);
 });

 document.getElementById('approvedCredits').textContent=approvedTotal;
 document.getElementById('progress').style.width=(approvedTotal/TOTAL*100)+'%';
}

function getAfter(container,y){
 return [...container.children].find(el=>{
  const box=el.getBoundingClientRect();
  return y < box.top + box.height/2;
 });
}

render();
</script>

</body>
</html>
