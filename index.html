<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Plan de Estudios - Derecho</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
body{font-family:'Poppins',sans-serif;background:linear-gradient(to bottom,#f7efff,#fcfaff);margin:0;padding:40px}
.header{text-align:center;margin-bottom:40px}
.header h1{font-size:36px;font-weight:600;color:#000;margin-bottom:5px}
.header p{font-size:18px;margin-top:5px;color:#333;font-weight:400}
.progress-container{width:60%;height:16px;background:#f2dfff;border-radius:999px;margin:15px auto;overflow:hidden}
.progress-bar{height:100%;background:#8238FF;width:0%;transition:width 0.3s;border-radius:999px}
.menu{margin-top:15px;text-align:center}.menu button{border:none;padding:10px 22px;border-radius:20px;cursor:pointer;background:#e8d4ff;font-weight:500;transition:.2s;margin:5px;color:#5b21b6;font-size:15px}.menu button:hover{background:#d8baff}.menu .btn-gray{background:#e6e6e6;color:#555}.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:35px;justify-items:center;width:100%}.grid .card:last-child{grid-column:2/3}.card{background:#faf4ff;border-radius:25px;padding:20px;border:2px solid #d9b8ff;box-shadow:0 4px 10px rgba(0,0,0,0.05);width:100%;max-width:350px}.card.complete{background:#f1e8ff;border-color:#a673ff}.sem-title{background:#8238FF;color:white;padding:12px 0;border-radius:16px;margin-bottom:10px;font-size:22px;font-weight:600;text-align:center}.info-line{display:flex;justify-content:center;align-items:center;gap:8px;margin-bottom:12px;font-weight:600}.credits-text{font-weight:600;color:#000}.tag{background:#9b53ff;color:white;padding:4px 10px;border-radius:12px;font-size:11px;display:inline-block}.subject{padding:12px;margin-bottom:10px;border-radius:18px;background:#f6edff;font-size:15px;cursor:pointer;transition:.2s;font-weight:400;user-select:none;color:#000}.subject:hover{background:#eedbff}.subject.checked{background:#e3c7ff;text-decoration:line-through;text-decoration-thickness:1.2px;color:#7a4bb3}.subject.dragging{opacity:.4}
.subject input{width:100%;padding:4px;border-radius:6px;border:none;font-size:15px}
</style>
</head>
<body>
<div class="header">
<h1>Plan de Estudios - Derecho</h1>
<p>Créditos aprobados: <span id="approvedCredits">0</span> / 183</p>
<div class="progress-container"><div id="progress" class="progress-bar"></div></div>
<div class="menu">
<button onclick="resetApproved()">Reiniciar</button>
<button class="btn-gray" onclick="formatAll()">Formatear</button>
</div>
</div>
<div id="grid" class="grid"></div>
<script>
const TOTAL_CREDITS=183;

const baseSemesters=[
  {name:'1° semestre',subjects:[{name:'Lógica y Retórica',credits:3,approved:false},{name:'Teoría General del Estado',credits:3,approved:false},{name:'Introducción al Derecho',credits:4,approved:false},{name:'Matemáticas',credits:3,approved:false},{name:'Escritura Universitaria I',credits:2,approved:false},{name:'CBU 1 – Colombia país de desigualdades',credits:2,approved:false}]},
  {name:'2° semestre',subjects:[{name:'Hermenéutica Jurídica',credits:3,approved:false},{name:'Derecho Romano',credits:3,approved:false},{name:'Sociología Jurídica',credits:3,approved:false},{name:'Historia de las Instituciones Jurídicas',credits:3,approved:false},{name:'Escritura Universitaria II',credits:2,approved:false},{name:'CBU 2 – Teatro, juventud y rebelión',credits:2,approved:false},{name:'CBU 3 – Colombia, espacio y tiempo',credits:2,approved:false}]},
  {name:'3° semestre',subjects:[{name:'Juez e Interpretación Constitucional',credits:3,approved:false},{name:'Obligaciones I',credits:5,approved:false},{name:'Derecho Constitucional',credits:5,approved:false},{name:'Propiedad y Derechos Reales',credits:3,approved:false},{name:'CBU 4 – Cantos de boga',credits:2,approved:false},{name:'Curso Libre Elección 1',credits:3,approved:false}]},
  {name:'4° semestre',subjects:[{name:'Teoría Jurídica',credits:5,approved:false},{name:'Obligaciones II',credits:5,approved:false},{name:'Legislación y Políticas Públicas',credits:3,approved:false},{name:'Derecho Internacional',credits:3,approved:false},{name:'CBU 5 – Quijote, dilemas universales',credits:2,approved:false}]},
  {name:'5° semestre',subjects:[{name:'Procedimientos',credits:4,approved:false},{name:'Relaciones Laborales',credits:3,approved:false},{name:'Derecho Comercial',credits:3,approved:false},{name:'Derecho Penal',credits:3,approved:false},{name:'Derecho Público Administrativo',credits:3,approved:false},{name:'CBU 6 – Mentalidad de Crecimiento',credits:2,approved:false}]},
  {name:'6° semestre',subjects:[{name:'Protección Laboral',credits:3,approved:false},{name:'Pruebas',credits:3,approved:false},{name:'Contratos',credits:5,approved:false},{name:'Penal Especial',credits:3,approved:false},{name:'Argumentación en Procesos Civiles',credits:3,approved:false},{name:'Materia Facultativa 1',credits:3,approved:false}]},
  {name:'7° semestre',subjects:[{name:'Relaciones Familiares',credits:4,approved:false},{name:'Sociedades',credits:3,approved:false},{name:'Contratos Estatales',credits:3,approved:false},{name:'Proceso Ejecutivo y Declarativo',credits:3,approved:false},{name:'Argumentación en Procesos Penales',credits:3,approved:false},{name:'CBU 7 – Historia del Sexo',credits:2,approved:false},{name:'Materia Facultativa 2',credits:3,approved:false}]},
  {name:'8° semestre',subjects:[{name:'Acciones Públicas',credits:3,approved:false},{name:'Títulos Valores',credits:3,approved:false},{name:'Derecho Comparado',credits:3,approved:false},{name:'Ética Profesional',credits:3,approved:false},{name:'Derecho Internacional Privado',credits:3,approved:false},{name:'Materia Facultativa 3',credits:3,approved:false},{name:'Curso Libre Elección 2',credits:3,approved:false}]},
  {name:'9° semestre',subjects:[{name:'Opciones de Grado',credits:3,approved:false},{name:'Consultorio Jurídico I',credits:4,approved:false},{name:'Materia Facultativa 4',credits:3,approved:false},{name:'Materia Facultativa 5',credits:3,approved:false},{name:'Curso Libre Elección 3',credits:3,approved:false},{name:'Curso Libre Elección 4',credits:3,approved:false}]},
  {name:'10° semestre',subjects:[{name:'Consultorio Jurídico II',credits:4,approved:false},{name:'Materia Facultativa 6',credits:3,approved:false}]}];

let semesters=JSON.parse(JSON.stringify(baseSemesters));

function save(){localStorage.setItem('malla',JSON.stringify(semesters))}
function load(){const data=JSON.parse(localStorage.getItem('malla'));if(data&&data.length===10)semesters=data}

function render(){
  const grid=document.getElementById('grid');
  grid.innerHTML='';
  let totalApproved=0;

  semesters.forEach((sem,si)=>{
    const card=document.createElement('div');
    card.className='card'+(si===9?' sem10':'');

    const approved=sem.subjects.filter(s=>s.approved).reduce((a,b)=>a+b.credits,0);
    const total=sem.subjects.reduce((a,b)=>a+b.credits,0);
    totalApproved+=approved;

    card.innerHTML=`<div class="sem-title">${sem.name}</div><div class="info-line">${approved}/${total}</div>`;

    const list=document.createElement('div');
    sem.subjects.forEach((sub,ci)=>{
      const div=document.createElement('div');
      div.className='subject'+(sub.approved?' checked':'');
      div.textContent=sub.name+' ('+sub.credits+')';
      div.draggable=true;

      div.onclick=()=>{sub.approved=!sub.approved;save();render()};

      div.ondblclick=e=>{
        e.stopPropagation();
        const input=document.createElement('input');
        input.value=sub.name;
        div.innerHTML='';
        div.appendChild(input);
        input.focus();
        input.onkeydown=ev=>{if(ev.key==='Enter'){sub.name=input.value;save();render()};if(ev.key==='Escape'){render()}};
        input.onblur=()=>{sub.name=input.value;save();render()};
      };

      div.ondragstart=e=>{
        e.dataTransfer.setData('text',JSON.stringify({sem:si,idx:ci,pos:ci}))
      };

      list.ondragover=e=>e.preventDefault();
      list.ondrop=e=>{
        const data=JSON.parse(e.dataTransfer.getData('text'));
        const moved=semesters[data.sem].subjects.splice(data.idx,1)[0];
        const newIdx=[...list.children].indexOf(div);
        sem.subjects.splice(newIdx,0,moved);
        save();render();
      };

      list.appendChild(div);
    });

    card.appendChild(list);
    grid.appendChild(card);
  });

  document.getElementById('approvedCredits').textContent=totalApproved;
  document.getElementById('progress').style.width=(totalApproved/TOTAL_CREDITS*100)+'%';
}

function resetApproved(){semesters.forEach(s=>s.subjects.forEach(m=>m.approved=false));save();render()}
function formatAll(){semesters=JSON.parse(JSON.stringify(baseSemesters));save();render()}

load();render();
</script>
</body>
</html>
